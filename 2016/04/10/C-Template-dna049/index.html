<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> C++ Template dna049 · 0.肆玖</title><meta name="description" content="C++ Template dna049 - dna049"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div id="mask" style="display: none;"><img id="mask-image" src="#" style=" "></div><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/dna049" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/dna049" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">C++ Template dna049</h1><div class="post-time">2016年4月10日</div><div class="post-content"><p>突然想到在此留点模板貌似是个不错的选择也 0.0</p>
<blockquote>
<p>虽说程序需求千变万化，但是一些短小精湛的函数块还是很值得整理收藏的。<br><a id="more"></a></p>
</blockquote>
<h3 id="u901A_u7528_u4EE3_u7801_u5757"><a href="#u901A_u7528_u4EE3_u7801_u5757" class="headerlink" title="通用代码块"></a>通用代码块</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//#pragma comment(linker,"/STACK:10240000,10240000")</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; PII;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;LL,LL&gt; PLL;</span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> clr(a,b) memset(a,b,sizeof(a))</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> MP make_pair</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> PB push_back</span></span><br><span class="line"><span class="comment">/*------------------------- template ------------------------------*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//    freopen("/Users/dna049/Desktop/AC/in","r",stdin);</span></span><br><span class="line"><span class="comment">//    freopen("/Users/dna049/Desktop/AC/out","w",stdout);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u6570_u8BBA_u7BC7"><a href="#u6570_u8BBA_u7BC7" class="headerlink" title="数论篇"></a>数论篇</h2><h4 id="Great_Common_divisor"><a href="#Great_Common_divisor" class="headerlink" title="Great Common divisor"></a>Great Common divisor</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">gcd</span><span class="params">(LL a,LL b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(a&amp;&amp;b&amp;&amp;(a&gt;b?a%=b:b%=a));</span><br><span class="line">	<span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">gcd</span><span class="params">(LL a,LL b)</span></span>&#123;	<span class="keyword">return</span> b?gcd(b,a%b):a;&#125;</span><br><span class="line"><span class="function">LL <span class="title">exgcd</span><span class="params">(LL a,LL b,LL&amp; x,LL&amp; y)</span></span>&#123;    <span class="keyword">if</span>(b==<span class="number">0</span>)&#123;</span><br><span class="line">        x=<span class="number">1</span>;y=<span class="number">0</span>;<span class="keyword">return</span> a;    &#125;    LL d=exgcd(b,a%b,x,y);</span><br><span class="line">    LL t=x;x=y;y=t-a/b*x;</span><br><span class="line">    <span class="keyword">return</span> d;&#125;</span><br></pre></td></tr></table></figure>
<p>当然用直接 GNU 内建函数 __gcd</p>
<h4 id="u6A21_u4E58_u6CD5_u9006_u5143"><a href="#u6A21_u4E58_u6CD5_u9006_u5143" class="headerlink" title="模乘法逆元"></a>模乘法逆元</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">inv</span><span class="params">(LL a,LL p)</span></span>&#123;     <span class="comment">// 0&lt;a&lt;p and gcd(a,p)=1</span>    <span class="keyword">if</span>(a==<span class="number">1</span>)    <span class="keyword">return</span> <span class="number">1</span>;    <span class="keyword">return</span> (p-p/a)*inv(p%a,p)%p;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u5FEB_u901F_u6A21_u52A0_u6CD5_u4E58_u6CD5"><a href="#u5FEB_u901F_u6A21_u52A0_u6CD5_u4E58_u6CD5" class="headerlink" title="快速模加法乘法"></a>快速模加法乘法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">mul_mod</span><span class="params">(LL x,LL n,LL p)</span></span>&#123;	    LL r=<span class="number">0</span>;    <span class="keyword">while</span>(n)&#123;        <span class="keyword">if</span>(n&amp;<span class="number">1</span>)&#123;            r+=x;            <span class="keyword">if</span>(r&gt;=m)    r-=m;        &#125;        n&gt;&gt;=<span class="number">1</span>;x&lt;&lt;=<span class="number">1</span>;        <span class="keyword">if</span>(x&gt;=m)    x-=m;    &#125;    <span class="keyword">return</span> r;&#125;</span><br><span class="line"><span class="function">LL <span class="title">pow_mod</span><span class="params">(LL x,LL n,LL p)</span></span>&#123;    LL r=<span class="number">1</span>;    <span class="keyword">while</span>(n)&#123;        <span class="keyword">if</span>(n&amp;<span class="number">1</span>) 	r=r*x%p;        n&gt;&gt;=<span class="number">1</span>;  	x=x*x%p;    &#125;    <span class="keyword">return</span> r;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u6A21_u6C42_u548C"><a href="#u6A21_u6C42_u548C" class="headerlink" title="模求和"></a>模求和</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LL getSum(LL a,LL n,LL p)&#123; //    a^1+a^2+...+a^n mod p(suit for matrix)    LL r=0,x=1;    while(n)&#123;        if(n&amp;1) r=(r+x*pow_mod(a,n,p))%p;        n&gt;&gt;=1;        x=x*(1+pow_mod(a,n,p))%p;    &#125;    return r;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u6A21_u5F00_u6839_u53F7"><a href="#u6A21_u5F00_u6839_u53F7" class="headerlink" title="模开根号"></a>模开根号</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LL modsqrt(LL a,LL p)&#123;  // find x such that x*x=a mod p;    if(p==2)    return (a&amp;1)?1:-1;    LL q=(p-1)&gt;&gt;1;    if(pow_mod(a,q,p)!=1)   return -1;  // no answer    if(q&amp;1) return pow_mod(a,(q+1)&gt;&gt;1,p);    LL b,cnt=1;    while(pow_mod(b=rand()%p,q,p)!=1);    while(!(q&amp;1))   ++cnt,q&gt;&gt;=1;    LL s,d,c=pow_mod(b,q,p),t=pow_mod(a,q,p),r=pow_mod(a,(q+1)&gt;&gt;1,p);// r*r=t*a;    while(t!=1)&#123;        for(s=1;s&lt;cnt&amp;&amp;pow_mod(t,1&lt;&lt;s,p)!=1;++s);        d=pow_mod(c,1&lt;&lt;(cnt-s-1),p);        r=(r*d)%p;c=d*d%p;t=t*c%p;        cnt=s;    &#125;    return r&lt;p-r?r:p-r;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u7EC4_u5408_u6570"><a href="#u7EC4_u5408_u6570" class="headerlink" title="组合数"></a>组合数</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">C</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    LL ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=n;i+m&gt;n;--i)&#123;</span><br><span class="line">        ans = ans*i/(n-i+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">12</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_C</span><span class="params">()</span></span>&#123;  </span><br><span class="line">    C[<span class="number">0</span>][<span class="number">0</span>]=C[<span class="number">1</span>][<span class="number">0</span>]=C[<span class="number">1</span>][<span class="number">1</span>]=<span class="number">1</span>;  </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=N;++i)&#123;  </span><br><span class="line">        c[i][<span class="number">0</span>]=c[i][i]=<span class="number">1</span>;  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;i;++j)&#123;</span><br><span class="line">        	c[i][j]=c[i-<span class="number">1</span>][j]+c[i-<span class="number">1</span>][j-<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="N_u4EE5_u5185_u7D20_u6570_u7B5B"><a href="#N_u4EE5_u5185_u7D20_u6570_u7B5B" class="headerlink" title="N以内素数筛"></a>N以内素数筛</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e7</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">bool</span> np[N];</span><br><span class="line"><span class="keyword">int</span> p[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getprime</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!np[i]) p[cnt++] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; cnt &amp;&amp; i * p[j] &lt; N; ++j) &#123;</span><br><span class="line">            np[i * p[j]] = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isp</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;N)	<span class="keyword">return</span> !np[n];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;p[i]*p[i]&lt;=n;++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n%p[i]==<span class="number">0</span>)	<span class="keyword">return</span> <span class="literal">false</span>;	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u5927_u7D20_u6570Miller-Rabin_u6982_u7387_u5224_u522B_u6CD5"><a href="#u5927_u7D20_u6570Miller-Rabin_u6982_u7387_u5224_u522B_u6CD5" class="headerlink" title="大素数Miller-Rabin概率判别法"></a>大素数Miller-Rabin概率判别法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Witness</span><span class="params">(LL a,LL n,LL m,<span class="keyword">int</span> t)</span></span>&#123;    LL x=pow_mod(a,m,n);    <span class="keyword">if</span>(x==<span class="number">1</span>||x==n-<span class="number">1</span>)    <span class="keyword">return</span> <span class="literal">false</span>;    <span class="keyword">while</span>(t--)&#123;        x=mul(x,x,n);        <span class="keyword">if</span>(x==n-<span class="number">1</span>)  <span class="keyword">return</span> <span class="literal">false</span>;    &#125;    <span class="keyword">return</span> <span class="literal">true</span>;&#125;<span class="function"><span class="keyword">bool</span> <span class="title">Rabin</span><span class="params">(LL n)</span></span>&#123;    <span class="keyword">if</span>(n&lt;<span class="number">2</span>)     <span class="keyword">return</span> <span class="literal">false</span>;    <span class="keyword">if</span>(n==<span class="number">2</span>)    <span class="keyword">return</span> <span class="literal">true</span>;    <span class="keyword">if</span>(!(n&amp;<span class="number">1</span>))  <span class="keyword">return</span> <span class="literal">false</span>;    LL m=n-<span class="number">1</span>;    <span class="keyword">int</span> t=<span class="number">0</span>,cnt=<span class="number">33</span>;    <span class="keyword">while</span>(!(m&amp;<span class="number">1</span>))&#123;        ++t;m&gt;&gt;=<span class="number">1</span>;    &#125;    <span class="keyword">while</span>(cnt--)&#123;        LL a=rand()%(n-<span class="number">1</span>)+<span class="number">1</span>;        <span class="keyword">if</span>(Witness(a,n,m,t))    <span class="keyword">return</span> <span class="literal">false</span>;    &#125;    <span class="keyword">return</span> <span class="literal">true</span>;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u5927_u6574_u6570_u7684_u6700_u5C0F_u7D20_u56E0_u5B50"><a href="#u5927_u6574_u6570_u7684_u6700_u5C0F_u7D20_u56E0_u5B50" class="headerlink" title="大整数的最小素因子"></a>大整数的最小素因子</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">pollard</span><span class="params">(LL n,<span class="keyword">int</span> c)</span></span>&#123;    LL x=rand()%(n-<span class="number">1</span>)+<span class="number">1</span>;    LL y=x,i=<span class="number">1</span>,k=<span class="number">2</span>;    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;        x=(mul(x,x,n)+c)%n;        LL d=gcd(y-x+n,n);        <span class="keyword">if</span>(d&gt;<span class="number">1</span>)    <span class="keyword">return</span> d;        <span class="keyword">if</span>(++i==k)&#123; <span class="comment">// I don't understand</span>            y=x;            k&lt;&lt;=<span class="number">1</span>;        &#125;    &#125;&#125;LL ans;<span class="function"><span class="keyword">void</span> <span class="title">findp</span><span class="params">(LL n)</span></span>&#123;    <span class="keyword">if</span>(Rabin(n))&#123;        ans=min(ans,n);        <span class="keyword">return</span>;    &#125;    LL p=n;    <span class="keyword">while</span>(p&gt;=n) p=pollard(p,rand() % (n-<span class="number">1</span>) +<span class="number">1</span>);    findp(p);    findp(n/p);&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Mobius_function"><a href="#Mobius_function" class="headerlink" title="Mobius function"></a>Mobius function</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e7</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">bool</span> np[N];</span><br><span class="line"><span class="keyword">int</span> mu[N],p[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getmu</span><span class="params">()</span></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>,cnt = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!np[i]) &#123;</span><br><span class="line">            p[cnt++] = i;</span><br><span class="line">            mu[i] = -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; cnt &amp;&amp; i * p[j] &lt; N; ++j) &#123;</span><br><span class="line">            <span class="keyword">int</span> t = i * p[j];</span><br><span class="line">            np[t] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % p[j])   mu[t] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Euler_u2019s_totient_function"><a href="#Euler_u2019s_totient_function" class="headerlink" title="Euler’s totient function"></a>Euler’s totient function</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">phi</span><span class="params">(LL x)</span></span>&#123;    LL r=x;    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;p[i]*p[i]&lt;=x;++i)&#123;        <span class="keyword">if</span>(x%p[i]==<span class="number">0</span>)&#123;            r=r/p[i]*(p[i]-<span class="number">1</span>);            <span class="keyword">while</span>(x%p[i]==<span class="number">0</span>)    x/=p[i];        &#125;    &#125;    <span class="keyword">if</span>(x&gt;<span class="number">1</span>) r=r/x*(x-<span class="number">1</span>);    <span class="keyword">return</span> r;&#125;<span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e7</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> phi[N];<span class="function"><span class="keyword">void</span> <span class="title">getphi</span><span class="params">()</span></span>&#123;    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i!=N;++i)   phi[i]=i;    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;N;i+=<span class="number">2</span>)   phi[i]&gt;&gt;=<span class="number">1</span>;    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;N;i+=<span class="number">2</span>)&#123;        <span class="keyword">if</span>(phi[i]!=i)	<span class="keyword">continue</span>;        <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;N;j+=i)	phi[j]=phi[j]/i*(i-<span class="number">1</span>);    &#125;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u6C42_u5947_u7D20_u6570_u7684_u4E00_u4E2A_u539F_u6839"><a href="#u6C42_u5947_u7D20_u6570_u7684_u4E00_u4E2A_u539F_u6839" class="headerlink" title="求奇素数的一个原根"></a>求奇素数的一个原根</h4><p>首先，模 $m$ 有原根的充要条件是：$m=2,4,p^a,2p^a$，其中$p$为奇素数。<br>对于求模$p$的原根方法：对 $p-1$ 素因子分解：$p-1 = p_1^{a_1} \cdots p_s^{a_s}$ 若恒有<br>$$ g^{\frac{p-1}{p_i}} \neq 1(mod \; p) $$<br>则 $g$ 是 模$p$的原根。对于 $p^a$ 可以用 $p$ 的原根简单构造，而 $2p^a$ 的原根为 $p^a$ 的原根 与 $p^a$ 的原根和 $p^a$的和中奇数者。(证明见P150《数论基础》潘承洞)<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">factor</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; p[i]*p[i]&lt;=n; ++i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%p[i]==<span class="number">0</span>)&#123;</span><br><span class="line">            fact[cnt++] = p[i];</span><br><span class="line">            <span class="keyword">while</span>(n%p[i]==<span class="number">0</span>) n /= p[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n &gt; <span class="number">1</span>) fact[cnt++] = n;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">proot</span><span class="params">(<span class="keyword">int</span> p)</span></span>&#123; <span class="comment">// p must be odd prime</span></span><br><span class="line">    <span class="keyword">int</span> cnt = factor(p-<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i&lt;p;++i)&#123;</span><br><span class="line">        <span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;cnt;++j)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pow_mod(i,(p-<span class="number">1</span>)/fact[j],p)==<span class="number">1</span>)&#123;</span><br><span class="line">                flag = <span class="literal">false</span>; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(flag)    <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>求所有原根见<a href="http://dna049.com/2016/02/16/二次剩余和Guass互反律/">我之前的博文</a></p>
</blockquote>
<h4 id="u6570_u8BBA_u51FD_u6570_u7684Dirichlet_u4E58_u79EF"><a href="#u6570_u8BBA_u51FD_u6570_u7684Dirichlet_u4E58_u79EF" class="headerlink" title="数论函数的Dirichlet乘积"></a>数论函数的Dirichlet乘积</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Dirichlet&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> a[N],n;</span><br><span class="line">    Dirichlet(<span class="keyword">int</span> _n = <span class="number">0</span>)&#123;</span><br><span class="line">        n=_n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">            a[i]=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Dirichlet <span class="keyword">operator</span>*(<span class="keyword">const</span> Dirichlet&amp; A)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="function">Dirichlet <span class="title">R</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;i*j&lt;=n;++j)&#123;</span><br><span class="line">                R.a[i*j]=a[i]*A.a[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">LL <span class="title">Dirichlet</span><span class="params">(<span class="keyword">int</span> n,LL a[],LL b[])</span></span>&#123;</span><br><span class="line">    LL ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> s=<span class="number">1</span>;s*s&lt;=n;++s)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n%s==<span class="number">0</span>)&#123;</span><br><span class="line">            ans + = a[s]*b[n/s];</span><br><span class="line">            <span class="keyword">if</span>(s*s!=n)  ans+=b[s]*a[n/s];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u7EBF_u6027_u540C_u4F59_u65B9_u7A0B"><a href="#u7EBF_u6027_u540C_u4F59_u65B9_u7A0B" class="headerlink" title="线性同余方程"></a>线性同余方程</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">modeq</span><span class="params">(LL a,LL b,LL n)</span></span>&#123; <span class="comment">// a*x=b mod n return x</span>    LL x,y,d;    d=exgcd(a,n,x,y);    <span class="keyword">if</span>(b%d!=<span class="number">0</span>) <span class="keyword">return</span> -<span class="number">1</span>;    a/=d;n/=d;b/=d;    <span class="keyword">return</span> ((x*b)%n+n)%n;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u4E2D_u56FD_u5269_u4F59_u5B9A_u7406"><a href="#u4E2D_u56FD_u5269_u4F59_u5B9A_u7406" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">chinaRemain</span><span class="params">(<span class="keyword">int</span> n,LL a[],LL m[])</span></span>&#123;<span class="comment">//x=a[i] mod m[i]</span>    LL x,y,a1,a2,m1,m2,d;    a1=a[<span class="number">0</span>],m1=m[<span class="number">0</span>];    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;        a2=a[i],m2=m[i];        d=exgcd(m1,m2,x,y);        <span class="keyword">if</span>((a2-a1)%d!=<span class="number">0</span>)    <span class="keyword">return</span> -<span class="number">1</span>;        a1+=(((a2-a1)/d*x)%m2+m2)%m2*m1;        m1=m1/d*m2;        a1=(a1%m1+m1)%m1;    &#125;    <span class="keyword">return</span> a1;&#125;</span><br></pre></td></tr></table></figure>
<h4 id="FFT"><a href="#FFT" class="headerlink" title="FFT"></a>FFT</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">double</span> *x,<span class="keyword">double</span> *y,<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, j = len&gt;&gt;<span class="number">1</span>; i &lt;len-<span class="number">1</span>; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; j)&#123;</span><br><span class="line">            <span class="keyword">double</span> tmp=x[i];x[i]=x[j];x[j]=tmp;</span><br><span class="line">            tmp=y[i];y[i]=y[j];y[j]=tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> k = len/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &gt;= k)&#123;</span><br><span class="line">            j -= k;</span><br><span class="line">            k /= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        j += k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(<span class="keyword">double</span> *x,<span class="keyword">double</span> *y,<span class="keyword">int</span> len,<span class="keyword">int</span> loglen,<span class="keyword">bool</span> isInverse)</span></span>&#123;</span><br><span class="line">    change(x,y,len);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> step=<span class="number">2</span>;step&lt;=len;step&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> half=step&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> theta=PI/half;</span><br><span class="line">        <span class="keyword">double</span> wmx=<span class="built_in">cos</span>(theta),wmy=<span class="built_in">sin</span>(theta);</span><br><span class="line">        <span class="keyword">if</span>(isInverse)   wmy=-wmy;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i+=step)&#123;</span><br><span class="line">            <span class="keyword">double</span> wx=<span class="number">1</span>,wy=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;half;++j)&#123;</span><br><span class="line">                <span class="keyword">double</span> cx=x[i+j],cy=y[i+j];</span><br><span class="line">                <span class="keyword">double</span> dx=x[i+j+half],dy=y[i+j+half];</span><br><span class="line">                <span class="keyword">double</span> ex=dx*wx-dy*wy,ey=dx*wy+dy*wx;</span><br><span class="line">                x[i+j]=cx+ex;y[i+j]=cy+ey;</span><br><span class="line">                x[i+j+half]=cx-ex;y[i+j+half]=cy-ey;</span><br><span class="line">                <span class="keyword">double</span> tmp=wx*wmx-wy*wmy;</span><br><span class="line">                wy=wx*wmy+wy*wmx;wx=tmp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(isInverse) <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;++i)&#123;</span><br><span class="line">        x[i]/=len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u5229_u7528FFT_u7684_u591A_u9879_u5F0F_u4E58_u6CD5"><a href="#u5229_u7528FFT_u7684_u591A_u9879_u5F0F_u4E58_u6CD5" class="headerlink" title="利用FFT的多项式乘法"></a>利用FFT的多项式乘法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> *b,<span class="keyword">int</span> len,<span class="keyword">int</span> loglen,<span class="keyword">bool</span> same)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=len;++i)&#123;</span><br><span class="line">        ax[i]=a[i];bx[i]=b[i];</span><br><span class="line">        ay[i]=by[i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fft(ax,ay,len,loglen,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(!same) fft(bx,by,len,loglen,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=len;++i)&#123;</span><br><span class="line">            bx[i]=ax[i];by[i]=ay[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=len;++i)&#123;</span><br><span class="line">        <span class="keyword">double</span> cx=ax[i]*bx[i]-ay[i]*by[i];</span><br><span class="line">        <span class="keyword">double</span> cy=ax[i]*by[i]+ay[i]*bx[i];</span><br><span class="line">        ax[i]=cx;ay[i]=cy;</span><br><span class="line">    &#125;</span><br><span class="line">    fft(ax,ay,len,loglen,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=len;++i)&#123;</span><br><span class="line">        a[i]=(<span class="keyword">int</span>)(ax[i]+<span class="number">0.5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=q-<span class="number">1</span>;i&gt;=<span class="number">0</span>;--i)&#123;</span><br><span class="line">        a[i+q-p]=(a[i+q-p]+ta*a[q+i])%M;</span><br><span class="line">        a[i]=(a[i]+tb*a[q+i])%M;</span><br><span class="line">        a[i+q]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u591A_u9879_u5F0F_u7C7B"><a href="#u591A_u9879_u5F0F_u7C7B" class="headerlink" title="多项式类"></a>多项式类</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Node&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> c,d;</span><br><span class="line">    Node* next;</span><br><span class="line">    Node()&#123;&#125;</span><br><span class="line">    Node(<span class="keyword">int</span> _c,<span class="keyword">int</span> _d):c(_c),d(_d)&#123;next=<span class="literal">NULL</span>;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> Poly&#123;     <span class="comment">// a0+a1*x+..+an*x^n</span></span><br><span class="line">    <span class="keyword">friend</span> ostream&amp; <span class="keyword">operator</span>&lt;&lt;(ostream&amp; os,<span class="keyword">const</span> Poly&amp; A)&#123;</span><br><span class="line">        <span class="keyword">if</span>(A.head-&gt;c==-<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(A.head-&gt;d==<span class="number">0</span>)    os&lt;&lt;<span class="string">"-1"</span>;</span><br><span class="line">            <span class="keyword">if</span>(A.head-&gt;d==<span class="number">1</span>)    os&lt;&lt;<span class="string">"-x"</span>;</span><br><span class="line">            <span class="keyword">if</span>(A.head-&gt;d&gt;<span class="number">1</span>)     os&lt;&lt;<span class="string">"-x^"</span>&lt;&lt;(A.head-&gt;d);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            os&lt;&lt;A.head-&gt;c;</span><br><span class="line">            <span class="keyword">if</span>(A.head-&gt;d==<span class="number">1</span>)    os&lt;&lt;<span class="string">"x"</span>;</span><br><span class="line">            <span class="keyword">if</span>(A.head-&gt;d&gt;<span class="number">1</span>)     os&lt;&lt;<span class="string">"x^"</span>&lt;&lt;(A.head-&gt;d);</span><br><span class="line">        &#125;</span><br><span class="line">        Node* p=A.head-&gt;next;</span><br><span class="line">        <span class="keyword">while</span>(p!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;c&gt;<span class="number">0</span>)      os&lt;&lt;<span class="string">"+"</span>;</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;c==-<span class="number">1</span>)    os&lt;&lt;<span class="string">"-"</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(p-&gt;c!=<span class="number">1</span>)     os&lt;&lt;(p-&gt;c);</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;d&gt;<span class="number">1</span>)  os&lt;&lt;<span class="string">"x^"</span>&lt;&lt;(p-&gt;d);</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;d==<span class="number">1</span>) os&lt;&lt;<span class="string">"x"</span>;</span><br><span class="line">            p=p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> os;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> Size;</span><br><span class="line">    Node *head;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Poly()&#123;</span><br><span class="line">        head=<span class="keyword">new</span> Node(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        Size=-<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Poly(<span class="keyword">int</span> x)&#123;</span><br><span class="line">        head=<span class="keyword">new</span> Node(x,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(x)   Size=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span>    Size=-<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Poly(<span class="keyword">int</span>* a,<span class="keyword">int</span> n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;<span class="number">1</span>) &#123;Poly();<span class="keyword">return</span>;&#125;</span><br><span class="line">        head=<span class="literal">NULL</span>;</span><br><span class="line">        Node* p;</span><br><span class="line">        <span class="keyword">for</span>(Size=n-<span class="number">1</span>;Size!=-<span class="number">1</span>&amp;&amp;a[Size]==<span class="number">0</span>;--Size);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=Size;i!=-<span class="number">1</span>;--i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[i])&#123;</span><br><span class="line">                p=<span class="keyword">new</span> Node(a[i],i);</span><br><span class="line">                p-&gt;next=head;</span><br><span class="line">                head=p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">NULL</span>)  head=<span class="keyword">new</span> Node(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="comment">//  if(head==NULL) new (this)poly();</span></span><br><span class="line">    &#125;</span><br><span class="line">    Poly(<span class="keyword">const</span> Poly&amp; A)&#123;</span><br><span class="line">        head=<span class="keyword">new</span> Node(A.head-&gt;c,A.head-&gt;d);</span><br><span class="line">        Size=A.Size;</span><br><span class="line">        Node *Ap=A.head-&gt;next,*p=head,*tp;</span><br><span class="line">        <span class="keyword">while</span>(Ap!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            tp=<span class="keyword">new</span> Node(Ap-&gt;c,Ap-&gt;d);</span><br><span class="line">            p-&gt;next=tp;p=tp;</span><br><span class="line">            Ap=Ap-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ~Poly()&#123;</span><br><span class="line">        del();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Node* p;</span><br><span class="line">        <span class="keyword">while</span>(head!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            p=head-&gt;next;</span><br><span class="line">            <span class="keyword">delete</span>(head);</span><br><span class="line">            head=p;</span><br><span class="line">        &#125;</span><br><span class="line">        Size=-<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Poly&amp; <span class="keyword">operator</span>=(<span class="keyword">const</span> Poly&amp; A)&#123;</span><br><span class="line">        del();</span><br><span class="line">        Size=A.Size;</span><br><span class="line">        head=<span class="keyword">new</span> Node(A.head-&gt;c,A.head-&gt;d);</span><br><span class="line">        Node *Ap=A.head-&gt;next,*p=head,*tp;</span><br><span class="line">        <span class="keyword">while</span>(Ap!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            tp=<span class="keyword">new</span> Node(Ap-&gt;c,Ap-&gt;d);</span><br><span class="line">            p-&gt;next=tp;p=tp;</span><br><span class="line">            Ap=Ap-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Poly <span class="keyword">operator</span>+(<span class="keyword">const</span> Poly&amp; A)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(Size&lt;A.Size) <span class="keyword">return</span> add(A,*<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">else</span>            <span class="keyword">return</span> add(*<span class="keyword">this</span>,A);</span><br><span class="line">    &#125;</span><br><span class="line">    Poly <span class="keyword">operator</span>-()<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="function">Poly <span class="title">R</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        Node *Rp=R.head;</span><br><span class="line">        <span class="keyword">while</span>(Rp!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            Rp-&gt;c=-Rp-&gt;c;</span><br><span class="line">            Rp=Rp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">    Poly <span class="keyword">operator</span>-(<span class="keyword">const</span> Poly&amp; A)<span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(Size&lt;A.Size) <span class="keyword">return</span> add(-A,*<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">else</span>            <span class="keyword">return</span> add(*<span class="keyword">this</span>,-A);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Poly <span class="title">mul</span><span class="params">(<span class="keyword">int</span> tc,<span class="keyword">int</span> td)</span><span class="keyword">const</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(tc==<span class="number">0</span>)       <span class="keyword">return</span> Poly();</span><br><span class="line">        <span class="keyword">if</span>(Size==-<span class="number">1</span>)    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        <span class="function">Poly <span class="title">R</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        Node *Rp=R.head;</span><br><span class="line">        <span class="keyword">while</span>(Rp!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            Rp-&gt;c*=tc;</span><br><span class="line">            Rp-&gt;d+=td;</span><br><span class="line">            R.Size=Rp-&gt;d;</span><br><span class="line">            Rp=Rp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">    Poly <span class="keyword">operator</span>*(Poly&amp; A)<span class="keyword">const</span>&#123;</span><br><span class="line">        Poly R;</span><br><span class="line">        Node *Ap=A.head;</span><br><span class="line">        <span class="keyword">while</span>(Ap!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            R=R+mul(Ap-&gt;c,Ap-&gt;d);</span><br><span class="line">            Ap=Ap-&gt;next;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> td)</span><span class="keyword">const</span></span>&#123;</span><br><span class="line">        Node *p=head;</span><br><span class="line">        <span class="keyword">while</span>(p!=<span class="literal">NULL</span>&amp;&amp;p-&gt;d&lt;td) p=p-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(p==<span class="literal">NULL</span>||p-&gt;d&gt;td)    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">else</span>                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getans</span><span class="params">(<span class="keyword">int</span> td)</span><span class="keyword">const</span></span>&#123;</span><br><span class="line">        Node *p=head;</span><br><span class="line">        <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(p!=<span class="literal">NULL</span>&amp;&amp;p-&gt;d&lt;=td)&#123;</span><br><span class="line">            ans+=p-&gt;c;</span><br><span class="line">            p=p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">friend</span> Poly <span class="title">add</span><span class="params">(<span class="keyword">const</span> Poly&amp; A,<span class="keyword">const</span> Poly&amp; B)</span></span>&#123;    <span class="comment">//A.Size&gt;=B.Size</span></span><br><span class="line">        <span class="function">Poly <span class="title">R</span><span class="params">(A)</span></span>;</span><br><span class="line">        <span class="keyword">if</span>(B.Size==-<span class="number">1</span>)   <span class="keyword">return</span> R;</span><br><span class="line">        Node *Bp=B.head,*Rp=R.head,*tp;</span><br><span class="line">        <span class="keyword">if</span>(R.head-&gt;d&gt;B.head-&gt;d)&#123;</span><br><span class="line">            tp=<span class="keyword">new</span> Node(B.head-&gt;c,B.head-&gt;d);</span><br><span class="line">            tp-&gt;next=R.head;</span><br><span class="line">            Rp=R.head=tp;</span><br><span class="line">            Bp=Bp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(Bp!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(Rp-&gt;d==Bp-&gt;d)&#123;</span><br><span class="line">                Rp-&gt;c+=Bp-&gt;c;</span><br><span class="line">                Bp=Bp-&gt;next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(Rp-&gt;next-&gt;d&gt;Bp-&gt;d)&#123;</span><br><span class="line">                    tp=<span class="keyword">new</span> Node(Bp-&gt;c,Bp-&gt;d);</span><br><span class="line">                    tp-&gt;next=Rp-&gt;next;</span><br><span class="line">                    Rp-&gt;next=tp;Rp=tp;</span><br><span class="line">                    Bp=Bp-&gt;next;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> Rp=Rp-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(R.head-&gt;next!=<span class="literal">NULL</span>&amp;&amp;R.head-&gt;c==<span class="number">0</span>)&#123;</span><br><span class="line">            Rp=R.head;</span><br><span class="line">            R.head=Rp-&gt;next;</span><br><span class="line">            <span class="keyword">delete</span>(Rp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(R.head-&gt;c==<span class="number">0</span>)    R.Size=-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>                R.Size=R.head-&gt;d;</span><br><span class="line">        Rp=R.head;</span><br><span class="line">        <span class="keyword">while</span>(Rp-&gt;next!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(Rp-&gt;next-&gt;c==<span class="number">0</span>)&#123;</span><br><span class="line">                tp=Rp-&gt;next;</span><br><span class="line">                Rp-&gt;next=tp-&gt;next;</span><br><span class="line">                <span class="keyword">delete</span>(tp);</span><br><span class="line">            &#125;</span><br><span class="line">            Rp=Rp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="u5927_u6570_u52A0_u4E58_u7C7B"><a href="#u5927_u6570_u52A0_u4E58_u7C7B" class="headerlink" title="大数加乘类"></a>大数加乘类</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> BigInt&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">262</span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> len,a[N];</span><br><span class="line">    BigInt()&#123;</span><br><span class="line">        len=<span class="number">1</span>;clr(a,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt(<span class="keyword">char</span> *s)&#123;</span><br><span class="line">        len=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> slen=<span class="built_in">strlen</span>(s);</span><br><span class="line">        <span class="keyword">while</span>(slen&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(--slen&gt;=<span class="number">0</span>) a[len]=s[slen]-<span class="string">'0'</span>;</span><br><span class="line">            <span class="keyword">if</span>(--slen&gt;=<span class="number">0</span>) a[len]+=<span class="number">10</span>*(s[slen]-<span class="string">'0'</span>);</span><br><span class="line">            <span class="keyword">if</span>(--slen&gt;=<span class="number">0</span>) a[len]+=<span class="number">100</span>*(s[slen]-<span class="string">'0'</span>);</span><br><span class="line">            <span class="keyword">if</span>(--slen&gt;=<span class="number">0</span>) a[len]+=<span class="number">1000</span>*(s[slen]-<span class="string">'0'</span>);</span><br><span class="line">            ++len;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>&amp; <span class="keyword">operator</span>[](<span class="keyword">int</span> x)&#123;</span><br><span class="line">        <span class="keyword">return</span> a[x];</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>+(<span class="keyword">const</span> BigInt&amp; A)<span class="keyword">const</span>&#123;</span><br><span class="line">        BigInt R;</span><br><span class="line">        R.len=max(len,A.len);</span><br><span class="line">        <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=R.len;++i)&#123;</span><br><span class="line">            res=a[i]+A.a[i]+res;</span><br><span class="line">            R[i]=res%<span class="number">10000</span>;</span><br><span class="line">            res/=<span class="number">10000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(;res;res/=<span class="number">10000</span>)  R[R.len++]=res%<span class="number">10000</span>;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>+(<span class="keyword">const</span> <span class="keyword">int</span>&amp; x)<span class="keyword">const</span>&#123;    <span class="comment">//x&lt;1e5</span></span><br><span class="line">        BigInt R;</span><br><span class="line">        <span class="keyword">int</span> res=x;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=len;++i)&#123;</span><br><span class="line">            res+=a[i];</span><br><span class="line">            R[i]=res%<span class="number">10000</span>;</span><br><span class="line">            res/=<span class="number">10000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        R.len=len;</span><br><span class="line">        <span class="keyword">for</span>(;res;res/=<span class="number">10000</span>)  R[R.len++]=res%<span class="number">10000</span>;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>-(<span class="keyword">const</span> <span class="keyword">int</span>&amp; x)<span class="keyword">const</span>&#123;    <span class="comment">//x&lt;=10000</span></span><br><span class="line">        BigInt R=*<span class="keyword">this</span>;</span><br><span class="line">        R[<span class="number">0</span>]-=x;</span><br><span class="line">        <span class="keyword">int</span> k=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(R[k]&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            R[k]+=<span class="number">10000</span>;</span><br><span class="line">            R[++k]-=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(R.len&gt;<span class="number">1</span>&amp;&amp;R[R.len-<span class="number">1</span>]==<span class="number">0</span>)    --R.len;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">BigInt <span class="title">getHalf</span><span class="params">()</span></span>&#123;</span><br><span class="line">        BigInt R=*<span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">int</span> x=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=R.len-<span class="number">1</span>;i!=-<span class="number">1</span>;--i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(x&amp;<span class="number">1</span>) R[i]+=<span class="number">10000</span>;</span><br><span class="line">            x=R[i]&amp;<span class="number">1</span>;</span><br><span class="line">            R[i]&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(len&gt;<span class="number">1</span>&amp;&amp;R[R.len-<span class="number">1</span>]==<span class="number">0</span>) --R.len;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">    BigInt <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">int</span>&amp; x)&#123; <span class="comment">//x&lt;=100000;</span></span><br><span class="line">        BigInt R;</span><br><span class="line">        <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=len;++i)&#123;</span><br><span class="line">            res+=a[i]*x;</span><br><span class="line">            R[i]=res%<span class="number">10000</span>;</span><br><span class="line">            res/=<span class="number">10000</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        R.len=len;</span><br><span class="line">        <span class="keyword">if</span>(res) R[R.len++]=res;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>,a[len-<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=len-<span class="number">2</span>;i&gt;=<span class="number">0</span>;--i)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%04d"</span>,a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="u77E9_u9635_u7C7B"><a href="#u77E9_u9635_u7C7B" class="headerlink" title="矩阵类"></a>矩阵类</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">LL mod;</span><br><span class="line"><span class="keyword">class</span> Matrix&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> N = <span class="number">2</span>; <span class="comment">//col</span></span><br><span class="line">    LL a[N][N];</span><br><span class="line">    Matrix(<span class="keyword">int</span> a00=<span class="number">0</span>,<span class="keyword">int</span> a01=<span class="number">0</span>, <span class="keyword">int</span> a10=<span class="number">0</span>,<span class="keyword">int</span> a11=<span class="number">0</span>)&#123;</span><br><span class="line">        a[<span class="number">0</span>][<span class="number">0</span>]=a00;a[<span class="number">0</span>][<span class="number">1</span>]=a01;</span><br><span class="line">        a[<span class="number">1</span>][<span class="number">0</span>]=a10;a[<span class="number">1</span>][<span class="number">1</span>]=a11;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">operator</span>+(<span class="keyword">const</span> Matrix&amp; A)<span class="keyword">const</span>&#123;</span><br><span class="line">        Matrix R;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;N;++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;N;++j)&#123;</span><br><span class="line">                R.a[i][j]=a[i][j]+A.a[i][j];</span><br><span class="line">                <span class="keyword">if</span>(R.a[i][j]&gt;=mod)   R.a[i][j]-=mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix <span class="keyword">operator</span>*(<span class="keyword">const</span> Matrix&amp; A)<span class="keyword">const</span>&#123;</span><br><span class="line">        Matrix R;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;N;++i)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;N;++k)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;N;++j)&#123;</span><br><span class="line">                    R.a[i][j] = (R.a[i][j]+a[i][k]*A.a[k][j])%mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">Matrix <span class="title">pow</span><span class="params">(Matrix A,LL n)</span></span>&#123;</span><br><span class="line">    <span class="function">Matrix <span class="title">R</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">while</span>(n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&amp;<span class="number">1</span>) R=R*A;</span><br><span class="line">        n&gt;&gt;=<span class="number">1</span>;  A=A*A;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> R;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u6570_u636E_u7ED3_u6784"><a href="#u6570_u636E_u7ED3_u6784" class="headerlink" title="数据结构"></a>数据结构</h2><h4 id="u5E76_u67E5_u96C6"><a href="#u5E76_u67E5_u96C6" class="headerlink" title="并查集"></a>并查集</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = x;</span><br><span class="line">    <span class="keyword">while</span>(ans!=p[ans])  ans=p[ans];</span><br><span class="line">    <span class="keyword">while</span>(x!=ans)&#123;</span><br><span class="line">        <span class="keyword">int</span> t = p[x];</span><br><span class="line">        p[x] = ans;</span><br><span class="line">        x = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u6570_u72B6_u6570_u7EC4"><a href="#u6570_u72B6_u6570_u7EC4" class="headerlink" title="数状数组"></a>数状数组</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> TreeArray&#123;</span><br><span class="line">    LL s[N];</span><br><span class="line">    <span class="keyword">int</span> Size;</span><br><span class="line">    TreeArray()&#123;&#125;</span><br><span class="line">    TreeArray(<span class="keyword">int</span> _S):Size(_S)&#123;clr(s,<span class="number">0</span>);&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n&amp;(-n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> id,<span class="keyword">int</span> p)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(id&lt;=Size)&#123;</span><br><span class="line">            s[id]+=p;</span><br><span class="line">            id+=lowbit(id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">LL <span class="title">sum</span><span class="params">(<span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">        LL r=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(id)&#123;</span><br><span class="line">            r+=s[id];</span><br><span class="line">            id-=lowbit(id);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="u7EBF_u6BB5_u6811"><a href="#u7EBF_u6BB5_u6811" class="headerlink" title="线段树"></a>线段树</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">define</span> lrt rt&lt;&lt;<span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> rrt rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> lson l,m,lrt</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> rson m+<span class="number">1</span>,r,rrt</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">100005</span>;</span><br><span class="line">LL sum[N&lt;&lt;<span class="number">2</span>],col[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PushUp</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    sum[rt]=sum[lrt]+sum[rrt];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PushDown</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(col[rt])&#123;</span><br><span class="line">        col[lrt]+=col[rt];</span><br><span class="line">        col[rrt]+=col[rt];</span><br><span class="line">        sum[lrt]+=(m-(m&gt;&gt;<span class="number">1</span>))*col[rt];</span><br><span class="line">        sum[rrt]+=(m&gt;&gt;<span class="number">1</span>)*col[rt];</span><br><span class="line">        col[rt]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%I64d"</span>,&amp;sum[rt]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    col[rt]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    build(lson);</span><br><span class="line">    build(rson);</span><br><span class="line">    PushUp(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> p,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r)&#123;</span><br><span class="line">        sum[rt]+=p*(r-l+<span class="number">1</span>);</span><br><span class="line">        col[rt]+=p;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    PushDown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=m)      update(L,R,p,lson);</span><br><span class="line">    <span class="keyword">if</span>(R&gt;m)       update(L,R,p,rson);</span><br><span class="line">    PushUp(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span><span class="params">(<span class="keyword">int</span> L,<span class="keyword">int</span> R,<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r)  <span class="keyword">return</span> sum[rt];</span><br><span class="line">    PushDown(rt,r-l+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">    LL ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L&lt;=m)    ans+=query(L,R,lson);</span><br><span class="line">    <span class="keyword">if</span>(R&gt;m)     ans+=query(L,R,rson);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="RMQ__u6C42_u533A_u95F4_u6700_u5C0F_u503C"><a href="#RMQ__u6C42_u533A_u95F4_u6700_u5C0F_u503C" class="headerlink" title="RMQ 求区间最小值"></a>RMQ 求区间最小值</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> RMQ&#123;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">10004</span>;<span class="keyword">public</span>:    <span class="keyword">int</span> n;    <span class="keyword">int</span> a[N][<span class="number">20</span>]; <span class="comment">//a[i][j]=max(a[i][0]---a[i+2^j-1])</span>    RMQ(<span class="keyword">int</span>* s,<span class="keyword">int</span> _n):n(_n)&#123;        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=n;++i)   a[i][<span class="number">0</span>]=s[i];        <span class="keyword">int</span> len=(<span class="keyword">int</span>)(<span class="built_in">log</span>(<span class="keyword">double</span>(n))/<span class="built_in">log</span>(<span class="number">2.0</span>))+<span class="number">2</span>;        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i!=len;++i)&#123;            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=n-(<span class="number">1</span>&lt;&lt;i);++j)&#123;                a[j][i]=max(a[j][i-<span class="number">1</span>],a[j+(<span class="number">1</span>&lt;&lt;(i-<span class="number">1</span>))][i-<span class="number">1</span>]);            &#125;        &#125;    &#125;    <span class="function"><span class="keyword">int</span> <span class="title">Min</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;        <span class="keyword">if</span>(r&gt;=n)    r=n-<span class="number">1</span>;        <span class="keyword">if</span>(l&lt;<span class="number">0</span>) l=<span class="number">0</span>;        <span class="keyword">int</span> len=(<span class="keyword">int</span>)(<span class="built_in">log</span>(<span class="keyword">double</span>(r-l+<span class="number">1</span>))/<span class="built_in">log</span>(<span class="number">2.0</span>));        <span class="keyword">return</span> max(a[l][len],a[r-(<span class="number">1</span>&lt;&lt;len)+<span class="number">1</span>][len]);    &#125;&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="u80CC_u5305"><a href="#u80CC_u5305" class="headerlink" title="背包"></a>背包</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX=<span class="number">100005</span>;</span><br><span class="line"><span class="keyword">int</span> r[MAX];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pack</span><span class="params">(<span class="keyword">int</span> cash,<span class="keyword">int</span> num,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(num==<span class="number">0</span>||w==<span class="number">0</span>||v==<span class="number">0</span>)  <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(num==<span class="number">1</span>)&#123; <span class="comment">//  0-1背包</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=cash;i&gt;=v;--i)</span><br><span class="line">            r[i]=max(r[i],r[i-v]+w);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(num*v&gt;=cash-v+<span class="number">1</span>)&#123; <span class="comment">//完全背包</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=v;i&lt;=cash;++i)</span><br><span class="line">            r[i]=max(r[i],r[i-v]+w);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> q[MAX],s[MAX],head,tail;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;v;++j)&#123;   <span class="comment">//多重背包</span></span><br><span class="line">        q[<span class="number">0</span>]=r[j];s[<span class="number">0</span>]=head=tail=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,k=j+v;k&lt;=cash;++i,k+=v)&#123;</span><br><span class="line">            q[i]=r[k]-i*w;</span><br><span class="line">            <span class="keyword">while</span>(s[head]&lt;i-num)    ++head;</span><br><span class="line">            <span class="keyword">while</span>(head&lt;=tail&amp;&amp;q[tail]&lt;q[i]) --tail;</span><br><span class="line">            s[++tail]=i;</span><br><span class="line">            q[tail]=q[i];</span><br><span class="line">            r[k]=q[head]+i*w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u5B57_u7B26_u4E32_u5339_u914D_u7684Sunday_u7B97_u6CD5"><a href="#u5B57_u7B26_u4E32_u5339_u914D_u7684Sunday_u7B97_u6CD5" class="headerlink" title="字符串匹配的Sunday算法"></a>字符串匹配的Sunday算法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> ASSIZE=<span class="number">256</span>;</span><br><span class="line"><span class="keyword">int</span> tp[ASSIZE];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getTp</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sLen=<span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=ASSIZE;++i)&#123;</span><br><span class="line">        tp[i]=sLen+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> <span class="keyword">char</span> *p=s;*p;++p)&#123;</span><br><span class="line">        tp[*p]=sLen-(p-s);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sunday</span><span class="params">(<span class="keyword">char</span> *ps,<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    getTp(s);</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *t,*p,*tx=ps;</span><br><span class="line">    <span class="keyword">int</span> pLen=<span class="built_in">strlen</span>(ps);</span><br><span class="line">    <span class="keyword">int</span> sLen=<span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">while</span>(tx+sLen&lt;=ps+pLen)&#123;</span><br><span class="line">        <span class="keyword">for</span>(t=tx,p=s;*p;++p,++t)&#123;</span><br><span class="line">            <span class="keyword">if</span>(*p!=*t)  <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(*p==<span class="string">'\0'</span>)    <span class="keyword">return</span> tx-ps;</span><br><span class="line">        tx+=tp[tx[sLen]];       </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u5B57_u7B26_u4E32_u5339_u914D_u7684KMP_u7B97_u6CD5"><a href="#u5B57_u7B26_u4E32_u5339_u914D_u7684KMP_u7B97_u6CD5" class="headerlink" title="字符串匹配的KMP算法"></a>字符串匹配的KMP算法</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNext</span><span class="params">(<span class="keyword">char</span> *s,<span class="keyword">int</span> *next)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j=<span class="number">0</span>,k=-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> sLen=<span class="built_in">strlen</span>(s)-<span class="number">1</span>;</span><br><span class="line">    next[<span class="number">0</span>]=-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(j&lt;sLen)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k==-<span class="number">1</span>||s[j]==s[k])&#123;</span><br><span class="line">            next[++j]=++k;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            k=next[k];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">KMP</span><span class="params">(<span class="keyword">char</span> *p,<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pLen=<span class="built_in">strlen</span>(p);</span><br><span class="line">    <span class="keyword">int</span> sLen=<span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">int</span> *next=<span class="keyword">new</span> <span class="keyword">int</span>[sLen];</span><br><span class="line">    getNext(s,next);</span><br><span class="line">    <span class="keyword">while</span>(i&lt;pLen&amp;&amp;j&lt;sLen)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j==-<span class="number">1</span>||p[i]==s[j])&#123;</span><br><span class="line">            ++i;++j;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            j=next[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span> [] next;</span><br><span class="line">    <span class="keyword">if</span>(j==sLen) <span class="keyword">return</span> i-j;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u4F18_u5148_u961F_u5217_u548C_u5355_u8C03_u6808"><a href="#u4F18_u5148_u961F_u5217_u548C_u5355_u8C03_u6808" class="headerlink" title="优先队列和单调栈"></a>优先队列和单调栈</h4><p>可以使用<a href="http://www.cplusplus.com/reference/" target="_blank" rel="external">C++ STL</a> 的 priority_queue，查找可用 lower_bound 和 upper_bound 。</p>
<h2 id="u56FE_u8BBA"><a href="#u56FE_u8BBA" class="headerlink" title="图论"></a>图论</h2><h4 id="u6700_u5927_u6D41"><a href="#u6700_u5927_u6D41" class="headerlink" title="最大流"></a>最大流</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> Node&#123;</span><br><span class="line">    <span class="keyword">int</span> t,w,next;</span><br><span class="line">&#125;a[N*N];</span><br><span class="line"><span class="keyword">int</span> n,ss,head[N],p[N],flow[N],c[N],h[N],numh[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    a[ss].t=y;</span><br><span class="line">    a[ss].w=w;</span><br><span class="line">    a[ss].next=head[x];</span><br><span class="line">    head[x]=ss++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">max_flow</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flow,ans=<span class="number">0</span>,neck,k;</span><br><span class="line">    <span class="built_in">memset</span>(h,<span class="number">0</span>,<span class="keyword">sizeof</span>(h));</span><br><span class="line">    <span class="built_in">memset</span>(numh,<span class="number">0</span>,<span class="keyword">sizeof</span>(numh));</span><br><span class="line">    <span class="built_in">memset</span>(p,-<span class="number">1</span>,<span class="keyword">sizeof</span>(p));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)   c[i]=head[i];</span><br><span class="line">    numh[<span class="number">0</span>]=n;</span><br><span class="line">    <span class="keyword">int</span> u=s;</span><br><span class="line">    <span class="keyword">while</span>(h[s]&lt;n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(u==t)&#123;</span><br><span class="line">            flow=<span class="number">1e9</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=s;i!=t;i=a[c[i]].t)&#123;</span><br><span class="line">                <span class="keyword">if</span>(flow&gt;a[c[i]].w)&#123;</span><br><span class="line">                    neck=i;flow=a[c[i]].w;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=s;i!=t;i=a[c[i]].t)&#123;</span><br><span class="line">                a[c[i]].w-=flow;</span><br><span class="line">                a[c[i]^<span class="number">1</span>].w+=flow;</span><br><span class="line">            &#125;</span><br><span class="line">            ans+=flow;</span><br><span class="line">            u=neck;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(k=c[u];k!=-<span class="number">1</span>;k=a[k].next)&#123;</span><br><span class="line">            <span class="keyword">if</span>(a[k].w&amp;&amp;h[u]==h[a[k].t]+<span class="number">1</span>)   <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k!=-<span class="number">1</span>)&#123;</span><br><span class="line">            c[u]=k;</span><br><span class="line">            p[a[k].t]=u;</span><br><span class="line">            u=a[k].t;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="number">0</span>==--numh[h[u]]) <span class="keyword">break</span>;</span><br><span class="line">            c[u]=head[u];</span><br><span class="line">            k=n;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i!=-<span class="number">1</span>;i=a[i].next)&#123;</span><br><span class="line">                <span class="keyword">if</span>(a[i].w)  k=min(k,h[a[i].t]);</span><br><span class="line">            &#125;</span><br><span class="line">            h[u]=k+<span class="number">1</span>;</span><br><span class="line">            ++numh[h[u]];</span><br><span class="line">            <span class="keyword">if</span>(u!=s)    u=p[u];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Stoer-Wagner__u6700_u5C0F_u5272"><a href="#Stoer-Wagner__u6700_u5C0F_u5272" class="headerlink" title="Stoer-Wagner 最小割"></a>Stoer-Wagner 最小割</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">102</span>;</span><br><span class="line"><span class="keyword">int</span> p[N],dis[N],<span class="built_in">map</span>[N][N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mincut</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret=<span class="number">0x7fffffff</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=n;++i)   p[i]=i;</span><br><span class="line">    <span class="keyword">while</span>(n&gt;<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> t=<span class="number">1</span>,s=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i!=n;++i)&#123;</span><br><span class="line">            dis[p[i]]=<span class="built_in">map</span>[p[<span class="number">0</span>]][p[i]];</span><br><span class="line">            <span class="keyword">if</span>(dis[p[i]]&gt;dis[p[t]]) t=i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</span><br><span class="line">        vis[p[<span class="number">0</span>]]=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i==n-<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(ret&gt;dis[p[t]]) ret=dis[p[t]];</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j!=n;++j)&#123;</span><br><span class="line">                    <span class="built_in">map</span>[p[j]][p[s]]+=<span class="built_in">map</span>[p[j]][p[t]];</span><br><span class="line">                    <span class="built_in">map</span>[p[s]][p[j]]=<span class="built_in">map</span>[p[j]][p[s]];</span><br><span class="line">                &#125;</span><br><span class="line">                p[t]=p[--n];</span><br><span class="line">            &#125;</span><br><span class="line">            vis[p[t]]=<span class="literal">true</span>;</span><br><span class="line">            s=t;t=-<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j!=n;++j)&#123;</span><br><span class="line">                <span class="keyword">if</span>(!vis[p[j]])&#123;</span><br><span class="line">                    dis[p[j]]+=<span class="built_in">map</span>[p[j]][p[s]];</span><br><span class="line">                    <span class="keyword">if</span>(t==-<span class="number">1</span>||dis[p[j]]&gt;dis[p[t]])  t=j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u6700_u77ED_u8DEFSPFA"><a href="#u6700_u77ED_u8DEFSPFA" class="headerlink" title="最短路SPFA"></a>最短路SPFA</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M=<span class="number">2000005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">1004</span>;</span><br><span class="line"><span class="keyword">int</span> head[N],rehead[N],dist[N],sc,v[N];</span><br><span class="line"><span class="keyword">struct</span> A&#123;</span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">int</span> g;</span><br><span class="line">    A()&#123;&#125;</span><br><span class="line">    A(<span class="keyword">int</span> x,<span class="keyword">int</span> y):id(x),g(y)&#123;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> A&amp; a)<span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> g+dist[id]&gt;a.g+dist[a.id];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">struct</span> Node&#123;</span><br><span class="line">    <span class="keyword">int</span> ed;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">    <span class="keyword">int</span> next;</span><br><span class="line">&#125;e[M];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span></span>&#123;</span><br><span class="line">    e[sc].ed=y;</span><br><span class="line">    e[sc].w=z;</span><br><span class="line">    e[sc].next=head[x];</span><br><span class="line">    head[x]=sc++;</span><br><span class="line">    e[sc].ed=x;</span><br><span class="line">    e[sc].w=z;</span><br><span class="line">    e[sc].next=rehead[y];</span><br><span class="line">    rehead[y]=sc++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(v,<span class="number">0</span>,<span class="keyword">sizeof</span>(v));</span><br><span class="line">    <span class="built_in">memset</span>(dist,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dist));</span><br><span class="line">    dist[s]=<span class="number">0</span>;</span><br><span class="line">    v[s]=<span class="literal">true</span>;</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    q.push(s);</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> u=q.front();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=rehead[u];i!=-<span class="number">1</span>;i=e[i].next)&#123;</span><br><span class="line">            <span class="keyword">int</span> ed=e[i].ed;</span><br><span class="line">            <span class="keyword">if</span>(dist[ed]&gt;dist[u]+e[i].w)&#123;</span><br><span class="line">                dist[ed]=dist[u]+e[i].w;</span><br><span class="line">                <span class="keyword">if</span>(!v[ed])&#123;</span><br><span class="line">                    v[ed]=<span class="literal">true</span>;</span><br><span class="line">                    q.push(ed);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        v[u]=<span class="literal">false</span>;</span><br><span class="line">        q.pop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u51E0_u4F55"><a href="#u51E0_u4F55" class="headerlink" title="几何"></a>几何</h2><h4 id="u4E8C_u7EF4_u51F8_u5305"><a href="#u4E8C_u7EF4_u51F8_u5305" class="headerlink" title="二维凸包"></a>二维凸包</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">const int N=501;</span><br><span class="line">int vc[N];</span><br><span class="line">struct Node&#123;</span><br><span class="line">    int x,y,id;</span><br><span class="line">    bool operator!=(const Node&amp; A)const&#123;</span><br><span class="line">        return x!=A.x||y!=A.y;</span><br><span class="line">    &#125;</span><br><span class="line">    bool operator&lt;(const Node&amp; A)const&#123;</span><br><span class="line">        if(y==A.y)  return x&lt;A.x;</span><br><span class="line">        return y&lt;A.y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;p[N],q[N];</span><br><span class="line">bool crossLeft(const Node&amp; op,const Node&amp; sp,const Node&amp; ep)&#123;</span><br><span class="line">    return (sp.x-op.x)*(ep.y-op.y)&gt;(sp.y-op.y)*(ep.x-op.x);</span><br><span class="line">&#125;</span><br><span class="line">int graham(int n)&#123;</span><br><span class="line">    sort(p,p+n);</span><br><span class="line">    if(n==0)    return 0;q[0]=p[0];</span><br><span class="line">    if(n==1)    return 1;q[1]=p[1];</span><br><span class="line">    if(n==2)    return 2;q[2]=p[2];</span><br><span class="line">    int top=1;</span><br><span class="line">    for(int i=2;i!=n;++i)&#123;</span><br><span class="line">        while(top&amp;&amp;crossLeft(q[top],p[i],q[top-1])) --top;</span><br><span class="line">        q[++top]=p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    int len=top;</span><br><span class="line">    q[++top]=p[n-2];</span><br><span class="line">    for(int i=n-3;i!=-1;--i)&#123;</span><br><span class="line">        while(top!=len&amp;&amp;crossLeft(q[top],p[i],q[top-1]))    --top;</span><br><span class="line">        q[++top]=p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    return top;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u51E0_u7C7B_u6839_u53F7_u7B97_u6CD5"><a href="#u51E0_u7C7B_u6839_u53F7_u7B97_u6CD5" class="headerlink" title="几类根号算法"></a>几类根号算法</h2><h4 id="1-_24s_28n_29__3D__5Csum__7Bi_3D1_7D_5E_7Bn_7D__5Clfloor__5Cfrac_7Bn_7D_7Bi_7D__5Crfloor__24"><a href="#1-_24s_28n_29__3D__5Csum__7Bi_3D1_7D_5E_7Bn_7D__5Clfloor__5Cfrac_7Bn_7D_7Bi_7D__5Crfloor__24" class="headerlink" title="1.$s(n) = \sum_{i=1}^{n} \lfloor \frac{n}{i} \rfloor $"></a>1.$s(n) = \sum_{i=1}^{n} \lfloor \frac{n}{i} \rfloor $</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">getsum</span><span class="params">(LL n)</span></span>&#123; </span><br><span class="line">    LL sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(LL i=<span class="number">1</span>,j;i&lt;=n;i=j+<span class="number">1</span>)&#123; </span><br><span class="line">        j = n/(n/i);</span><br><span class="line">        sum += (j-i+<span class="number">1</span>)*(n/i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-_24_5Csum__7Bi_3D1_7D_5En__5Clfloor__5Cfrac_7Bn_7D_7Bi_7D__5Crfloor__5Clfloor__5Cfrac_7Bm_7D_7Bi_7D__5Crfloor_f_28i_29_24"><a href="#2-_24_5Csum__7Bi_3D1_7D_5En__5Clfloor__5Cfrac_7Bn_7D_7Bi_7D__5Crfloor__5Clfloor__5Cfrac_7Bm_7D_7Bi_7D__5Crfloor_f_28i_29_24" class="headerlink" title="2.$\sum_{i=1}^n \lfloor \frac{n}{i} \rfloor \lfloor \frac{m}{i} \rfloor f(i)$"></a>2.$\sum_{i=1}^n \lfloor \frac{n}{i} \rfloor \lfloor \frac{m}{i} \rfloor f(i)$</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">getsum</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123; <span class="comment">// g[i]=f[i]+g[i-1]</span></span><br><span class="line">    LL sum = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j;i&lt;=min(n,m);i=j+<span class="number">1</span>)&#123;</span><br><span class="line">		j=min(n/(n/i),m/(m/i)</span><br><span class="line">		sum += LL(n/i)*(m/i)*(g[j]-g[i-<span class="number">1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-_24h_28n_29__3D__5Cfrac_7Bn_28n-1_29_28n-2_29_7D_7B3_7D_-__5Csum__7Bi_3D2_7D_5En_h_28_5Clfloor__5Cfrac_7Bn_7D_7Bi_7D__5Crfloor_29_24"><a href="#3-_24h_28n_29__3D__5Cfrac_7Bn_28n-1_29_28n-2_29_7D_7B3_7D_-__5Csum__7Bi_3D2_7D_5En_h_28_5Clfloor__5Cfrac_7Bn_7D_7Bi_7D__5Crfloor_29_24" class="headerlink" title="3.$h(n) = \frac{n(n-1)(n-2)}{3} - \sum_{i=2}^n h(\lfloor \frac{n}{i} \rfloor)$"></a>3.$h(n) = \frac{n(n-1)(n-2)}{3} - \sum_{i=2}^n h(\lfloor \frac{n}{i} \rfloor)$</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getans</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123; </span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;::iterator it = mp.find(n);</span><br><span class="line">    <span class="keyword">if</span> (it != mp.end())  <span class="keyword">return</span> it-&gt;second;</span><br><span class="line">    <span class="keyword">int</span> r = LL(n)*(n-<span class="number">1</span>)%M*(n-<span class="number">2</span>)%M*inv3%M;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>,j;i&lt;=n;i=j+<span class="number">1</span>)&#123;</span><br><span class="line">        j = n/(n/i);</span><br><span class="line">        r -= LL(j-i+<span class="number">1</span>)*getans(n/i)%M;</span><br><span class="line">        <span class="keyword">if</span>(r&lt;<span class="number">0</span>) r+=M;</span><br><span class="line">    &#125;</span><br><span class="line">    mp.insert(pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;(n,r));</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="To_Be_Continue"><a href="#To_Be_Continue" class="headerlink" title="To Be Continue"></a>To Be Continue</h2></div></article></div></section><footer><div class="paginator"><a href="/2016/04/10/POJ2559-单调栈/" class="next">NEXT</a></div><div data-thread-key="2016/04/10/C-Template-dna049/" data-title="C++ Template dna049" data-url="http://dna049.com/2016/04/10/C-Template-dna049/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"dna049"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2015 - 2016 <a href="http://dna049.com">dna049</a>, unless otherwise noted.</p></div></footer></div><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?699b245cef6684fc1e306cd9cc1cb26a";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</body></html>